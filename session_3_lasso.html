<!DOCTYPE html>
<html lang="en"><head>
<script src="session_3_lasso_files/libs/clipboard/clipboard.min.js"></script>
<script src="session_3_lasso_files/libs/quarto-html/tabby.min.js"></script>
<script src="session_3_lasso_files/libs/quarto-html/popper.min.js"></script>
<script src="session_3_lasso_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="session_3_lasso_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="session_3_lasso_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="session_3_lasso_files/libs/quarto-html/quarto-syntax-highlighting-d4d76bf8491c20bad77d141916dc28e1.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.43">

  <meta name="author" content="Catalina Cañizares, Ph.D.&nbsp;y Francisco Cardozo Ph.D.">
  <title>Técnicas de Regularización: Ridge, Lasso y Elastic Net usando tidymodels</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="session_3_lasso_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="session_3_lasso_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="session_3_lasso_files/libs/revealjs/dist/theme/quarto-8f3eebe07241f08526c91a7e9cbef8fd.css">
  <link rel="stylesheet" href="lasso-css.css">
  <link href="session_3_lasso_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="session_3_lasso_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="session_3_lasso_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="session_3_lasso_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Técnicas de Regularización: Ridge, Lasso y Elastic Net usando <code>tidymodels</code></h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Catalina Cañizares, Ph.D.&nbsp;y Francisco Cardozo Ph.D. 
</div>
</div>
</div>

</section>
<section id="acerca-de-este-material" class="slide level2">
<h2>Acerca de Este Material</h2>
<blockquote>
<p>Técnicas de Regularización: Ridge, Lasso y Elastic Net usando <code>tidymodels</code> © 2024 por Catalina Canizares y Francisco Cardozo está licenciado bajo Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International</p>
</blockquote>
<p>Este material está disponible libremente bajo la Licencia Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International.</p>
<p>Para más información sobre esta licencia, por favor visite: <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">Licencia Creative Commons</a></p>
</section>
<section id="reducción-shrinkage" class="slide level2">
<h2>Reducción (Shrinkage)</h2>
<ul>
<li>La reducción es una técnica que “reduce” o disminuye los coeficientes de las variables predictoras a cero.</li>
<li>Los métodos de reducción logran un equilibrio entre capturar las relaciones en los datos y evitar el sobreajuste.</li>
<li>Reducir las estimaciones de los coeficientes puede disminuir significativamente la varianza.</li>
<li>Las dos técnicas más conocidas para reducir los coeficientes de regresión hacia cero son la regresión ridge y el lasso.</li>
</ul>
<div class="footer">
<p><a href="https://hastie.su.domains/ISLR2/ISLRv2_website.pdf">ISLRv2</a></p>
</div>
</section>
<section id="suma-residual-de-cuadrados-rss" class="slide level2">
<h2>Suma Residual de Cuadrados (RSS)</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>El RSS mide la cantidad de error que queda entre la función de regresión y el conjunto de datos después de ejecutar el modelo.<br>
Un RSS más pequeño representa una función de regresión que se ajusta bien a los datos.</p>
<p><span class="math display">\[
\text{RSS} = \sum_{i=1}^n\bigg( y_i - \beta_0 - \sum_{j=1}^p \beta_j x_{ij}\bigg)^2
\]</span></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/rss.png"></p>
</div></div>
<div class="footer">
<p><a href="https://hastie.su.domains/ISLR2/ISLRv2_website.pdf">ISLRv2</a></p>
</div>
</section>
<section>
<section id="regresión-ridge" class="title-slide slide level1 center">
<h1>Regresión Ridge</h1>

</section>
<section id="ridge" class="slide level2">
<h2>Ridge</h2>
<ul>
<li><p>La regresión ridge es una técnica de regularización que agrega un término de penalización (<span class="math inline">\(\lambda\)</span>) al RSS.</p></li>
<li><p>Reduce los coeficientes de regresión hacia cero, disminuyendo su impacto en el modelo.</p></li>
<li><p>También se conoce como regularización L2</p></li>
<li><p>La fórmula para la regresión Ridge es: <span class="math display">\[
\sum_{i=1}^n\bigg( y_i - \beta_0 - \sum_{j=1}^p \beta_j x_{ij}\bigg)^2 + \lambda \sum_{j=1}^p \beta_j^2
\]</span></p></li>
</ul>
<div class="footer">
<p><a href="https://hastie.su.domains/ISLR2/ISLRv2_website.pdf">ISLRv2</a></p>
</div>
</section>
<section id="ridge-1" class="slide level2">
<h2>Ridge</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/ridge_graph.png"></p>
</div><div class="column" style="width:50%;">
<p>Cuando <span class="math inline">\(\lambda\)</span> es extremadamente grande, todas las estimaciones de los coeficientes ridge son básicamente cero; esto corresponde al modelo nulo que no contiene predictores.</p>
</div></div>
<div class="footer">
<p><a href="https://hastie.su.domains/ISLR2/ISLRv2_website.pdf">ISLRv2</a></p>
</div>
</section></section>
<section>
<section id="lasso" class="title-slide slide level1 center">
<h1>Lasso</h1>

</section>
<section id="lasso-1" class="slide level2">
<h2>Lasso</h2>
<ul>
<li><p>Lasso (Operador de Reducción y Selección de Mínimos Absolutos) es otra técnica de regularización que agrega un término de penalización (<span class="math inline">\(\lambda\)</span>) al RSS</p></li>
<li><p>Tiene una propiedad incorporada de selección de características, ya que puede reducir los coeficientes exactamente a cero.</p></li>
<li><p>También se conoce como regularización L1</p></li>
</ul>
<p><span class="math display">\[
\sum_{i=1}^n\bigg( y_i - \beta_0 - \sum_{j=1}^p \beta_j x_{ij}\bigg)^2 + \lambda \sum_{j=1}^p | \beta_j|
\]</span></p>
<div class="footer">
<p><a href="https://hastie.su.domains/ISLR2/ISLRv2_website.pdf">ISLRv2</a></p>
</div>
</section>
<section id="lasso-2" class="slide level2">
<h2>Lasso</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/lasso_graph.png"></p>
</div><div class="column" style="width:50%;">
<p>Cuando λ = 0, el lasso simplemente da el ajuste de mínimos cuadrados, y cuando <span class="math inline">\(\lambda\)</span> se vuelve suficientemente grande, el lasso da el modelo nulo en el que todas las estimaciones de coeficientes son iguales a cero.</p>
</div></div>
<div class="footer">
<p><a href="https://hastie.su.domains/ISLR2/ISLRv2_website.pdf">ISLRv2</a></p>
</div>
</section>
<section id="comparar-ridge-vs.-lasso" class="slide level2">
<h2>Comparar Ridge vs.&nbsp;Lasso</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/lasso_graph.png"></p>
<p>Dependiendo del valor de <span class="math inline">\(\lambda\)</span>, el lasso puede producir un modelo que involucre cualquier número de variables.</p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/ridge_graph.png"> Ridge siempre incluirá todas las variables en el modelo, aunque la magnitud de las estimaciones de los coeficientes dependerá de <span class="math inline">\(\lambda\)</span></p>
</div></div>
<div class="footer">
<p><a href="https://hastie.su.domains/ISLR2/ISLRv2_website.pdf">ISLRv2</a></p>
</div>
</section>
<section id="la-propiedad-de-selección-de-variables-del-lasso" class="slide level2">
<h2>La Propiedad de Selección de Variables del Lasso</h2>

<img data-src="img/Contours%20.png" class="r-stretch"><p>-El hecho de que algunos coeficientes del lasso se reduzcan completamente a cero explica por qué el lasso realiza selección de características</p>
<aside class="notes">
<p>La estimación de mínimos cuadrados está marcada como beta sombrero, Las regiones restrictivas están en gris, la región de diamante es para el lasso, la región de círculo es para el ridge. Las elipses centradas alrededor de βˆ representan un contorno de RSS A medida que las elipses se expanden, el RSS aumenta. Las estimaciones de lasso y ridge son los primeros puntos en los que una elipse contrae la región gris.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="footer">
<p><a href="https://hastie.su.domains/ISLR2/ISLRv2_website.pdf">ISLRv2</a></p>
</div>
</section>
<section id="elastic-net" class="slide level2">
<h2>Elastic Net</h2>
<ul>
<li>Es una generalización de la regresión lasso y ridge</li>
<li>Combina las dos penalizaciones.</li>
<li>La fórmula para Elastic Net:</li>
</ul>
<p><span class="math display">\[
\sum_{i=1}^n\bigg( y_i - \beta_0 - \sum_{j=1}^p \beta_j x_{ij}\bigg)^2 + \lambda \sum_{j=1}^p \beta_j^2  + \lambda \sum_{j=1}^p | \beta_j|
\]</span></p>
<div class="footer">
<p><a href="https://hastie.su.domains/ISLR2/ISLRv2_website.pdf">ISLRv2</a></p>
</div>
</section>
<section id="elastic-net-1" class="slide level2">
<h2>Elastic Net</h2>
<p>La ventaja del elastic net es que <strong>mantiene la calidad de selección de características</strong> de la penalización lasso así como la <strong>efectividad de la penalización ridge</strong>.</p>
<div class="footer">
<p><a href="https://scientistcafe.com/ids/elastic-net.html">Practitioner’s Guide to Data Science</a></p>
</div>
</section>
<section id="cómo-elegimos-el-mejor-lambda" class="slide level2 scrollable">
<h2>¿Cómo elegimos el mejor <span class="math inline">\(\lambda\)</span>?</h2>
<ol type="1">
<li>Usando métodos de remuestreo</li>
</ol>
<ul>
<li>Verificar el rendimiento usando RMSE o ROC-AUC</li>
</ul>
<ol start="2" type="1">
<li>Podemos verificar desde sin reducción hasta tanto que no nos queden predictores (lasso)</li>
</ol>
</section></section>
<section>
<section id="lasso-con-tidymodels" class="title-slide slide level1 center">
<h1>Lasso con <code>tidymodels</code></h1>

<img data-src="img/woody_amazed.gif" class="r-stretch"></section>
<section id="tarea" class="slide level2">
<h2>Tarea</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Determinar los predictores clave de un conjunto integral de 42 comportamientos de riesgo, que incluyen el consumo de alcohol y drogas, así como actividades imprudentes, con el objetivo principal de predecir con precisión la probabilidad de participar en <strong>enviar mensajes de texto y conducir</strong>.</p>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p><img data-src="https://media.giphy.com/media/eGyJz0UnrEy3K/giphy.gif?cid=ecf05e470l48hi14w34gpqwhaddfljk9xuwn2xir0rn52323&amp;ep=v1_gifs_search&amp;rid=giphy.gif&amp;ct=g"></p>
</div>
</div></div>
</section>
<section id="los-datos---riskybehaviors" class="slide level2">
<h2>Los Datos - <code>riskyBehaviors</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="fu">library</span>(MLearnYRBSS)</span>
<span id="cb1-2"><a href=""></a><span class="fu">data</span>(<span class="st">"riskyBehaviors"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="limpieza-de-datos" class="slide level2">
<h2>Limpieza de Datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" data-code-line-numbers="1|2|3|4|5|6|7|8|9|10|11|12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a>riskyBehaviors_analysis <span class="ot">&lt;-</span></span>
<span id="cb2-2"><a href=""></a>    riskyBehaviors <span class="sc">|&gt;</span></span>
<span id="cb2-3"><a href=""></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-4"><a href=""></a>        <span class="at">TextingDriving =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-5"><a href=""></a>            TextingDriving <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb2-6"><a href=""></a>            TextingDriving <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>) <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb2-7"><a href=""></a>            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA</span></span>
<span id="cb2-8"><a href=""></a>        )</span>
<span id="cb2-9"><a href=""></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb2-10"><a href=""></a>    <span class="fu">mutate</span>(<span class="at">TextingDriving =</span> <span class="fu">factor</span>(TextingDriving)) <span class="sc">|&gt;</span></span>
<span id="cb2-11"><a href=""></a>    <span class="fu">drop_na</span>(TextingDriving) <span class="sc">|&gt;</span></span>
<span id="cb2-12"><a href=""></a>    <span class="fu">select</span>(</span>
<span id="cb2-13"><a href=""></a>        <span class="sc">-</span>SourceVaping,</span>
<span id="cb2-14"><a href=""></a>        <span class="sc">-</span>SourceAlcohol,</span>
<span id="cb2-15"><a href=""></a>        <span class="sc">-</span>SexOrientation,</span>
<span id="cb2-16"><a href=""></a>        <span class="sc">-</span>DrivingDrinking,</span>
<span id="cb2-17"><a href=""></a>        <span class="sc">-</span>SexualAbuse,</span>
<span id="cb2-18"><a href=""></a>        <span class="sc">-</span>SexualAbuseByPartner,</span>
<span id="cb2-19"><a href=""></a>        <span class="sc">-</span>Grade,</span>
<span id="cb2-20"><a href=""></a>        <span class="sc">-</span>Age</span>
<span id="cb2-21"><a href=""></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="división-entrenamiento---prueba" class="slide level2">
<h2>División Entrenamiento - Prueba</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" data-code-line-numbers="1|3|4|6|7|9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">1990</span>)</span>
<span id="cb3-2"><a href=""></a></span>
<span id="cb3-3"><a href=""></a>analysis_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(</span>
<span id="cb3-4"><a href=""></a>    riskyBehaviors_analysis,</span>
<span id="cb3-5"><a href=""></a>    <span class="at">strata =</span> TextingDriving</span>
<span id="cb3-6"><a href=""></a>)</span>
<span id="cb3-7"><a href=""></a></span>
<span id="cb3-8"><a href=""></a>analysis_train <span class="ot">&lt;-</span> <span class="fu">training</span>(analysis_split)</span>
<span id="cb3-9"><a href=""></a>analysis_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(analysis_split)</span>
<span id="cb3-10"><a href=""></a></span>
<span id="cb3-11"><a href=""></a>analysis_split</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Training/Testing/Total&gt;
&lt;8169/2725/10894&gt;</code></pre>
</div>
</div>
</section>
<section id="verifiquemos-nuestro-trabajo" class="slide level2">
<h2>Verifiquemos Nuestro Trabajo</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb5" data-code-line-numbers="1|2|3|4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a>analysis_train <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href=""></a>    <span class="fu">tabyl</span>(TextingDriving) <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href=""></a>    <span class="fu">adorn_pct_formatting</span>(<span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a href=""></a>    <span class="fu">adorn_totals</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code> TextingDriving    n percent
              0 3654     45%
              1 4515     55%
          Total 8169       -</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb7" data-code-line-numbers="1|2|3|4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a>analysis_test <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href=""></a>    <span class="fu">tabyl</span>(TextingDriving) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href=""></a>    <span class="fu">adorn_pct_formatting</span>(<span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href=""></a>    <span class="fu">adorn_totals</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code> TextingDriving    n percent
              0 1219     45%
              1 1506     55%
          Total 2725       -</code></pre>
</div>
</div>
</div></div>
</section>
<section id="validación-cruzada" class="slide level2">
<h2>Validación Cruzada</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" data-code-line-numbers="1|3|5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">1990</span>)</span>
<span id="cb9-2"><a href=""></a></span>
<span id="cb9-3"><a href=""></a>analysis_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(analysis_train, <span class="at">v =</span> <span class="dv">5</span>)</span>
<span id="cb9-4"><a href=""></a>analysis_folds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>#  5-fold cross-validation 
# A tibble: 5 × 2
  splits              id   
  &lt;list&gt;              &lt;chr&gt;
1 &lt;split [6535/1634]&gt; Fold1
2 &lt;split [6535/1634]&gt; Fold2
3 &lt;split [6535/1634]&gt; Fold3
4 &lt;split [6535/1634]&gt; Fold4
5 &lt;split [6536/1633]&gt; Fold5</code></pre>
</div>
</div>
</section>
<section id="receta" class="slide level2">
<h2>Receta</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" data-code-line-numbers="1|2|3|4|5|6|7|9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a>texting_rec <span class="ot">&lt;-</span></span>
<span id="cb11-2"><a href=""></a>    <span class="fu">recipe</span>(TextingDriving <span class="sc">~</span> ., <span class="at">data =</span> analysis_train) <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href=""></a>    <span class="fu">step_zv</span>(<span class="fu">all_predictors</span>()) <span class="sc">|&gt;</span></span>
<span id="cb11-4"><a href=""></a>    <span class="fu">step_impute_mode</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">|&gt;</span></span>
<span id="cb11-5"><a href=""></a>    <span class="fu">step_impute_mean</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">|&gt;</span></span>
<span id="cb11-6"><a href=""></a>    <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">|&gt;</span></span>
<span id="cb11-7"><a href=""></a>    <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())</span>
<span id="cb11-8"><a href=""></a></span>
<span id="cb11-9"><a href=""></a>texting_rec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
</section>
<section id="especificación" class="slide level2">
<h2>Especificación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" data-code-line-numbers="1|2|3|4|5|6|7|8|10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a>texting_spec <span class="ot">&lt;-</span></span>
<span id="cb12-2"><a href=""></a>    <span class="fu">logistic_reg</span>(<span class="at">penalty =</span> <span class="fu">tune</span>(), <span class="at">mixture =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href=""></a>    <span class="co"># mixture = 1 especifica un modelo lasso puro,</span></span>
<span id="cb12-4"><a href=""></a>    <span class="co"># mixture = 0 especifica un modelo de regresión ridge, y</span></span>
<span id="cb12-5"><a href=""></a>    <span class="co"># 0 &lt; mixture &lt; 1 especifica un modelo elastic net, interpolando lasso y ridge.</span></span>
<span id="cb12-6"><a href=""></a>    <span class="co"># https://parsnip.tidymodels.org/reference/glmnet-details.html</span></span>
<span id="cb12-7"><a href=""></a>    <span class="fu">set_engine</span>(<span class="st">'glmnet'</span>)</span>
<span id="cb12-8"><a href=""></a></span>
<span id="cb12-9"><a href=""></a>texting_spec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>Logistic Regression Model Specification (classification)

Main Arguments:
  penalty = tune()
  mixture = 1

Computational engine: glmnet </code></pre>
</div>
</div>
</section>
<section id="flujo-de-trabajo" class="slide level2">
<h2>Flujo de Trabajo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" data-code-line-numbers="1|2|3|4|6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a>texting_wf <span class="ot">&lt;-</span></span>
<span id="cb14-2"><a href=""></a>    <span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href=""></a>    <span class="fu">add_recipe</span>(texting_rec) <span class="sc">|&gt;</span></span>
<span id="cb14-4"><a href=""></a>    <span class="fu">add_model</span>(texting_spec)</span>
<span id="cb14-5"><a href=""></a></span>
<span id="cb14-6"><a href=""></a>texting_wf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: logistic_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
5 Recipe Steps

• step_zv()
• step_impute_mode()
• step_impute_mean()
• step_normalize()
• step_dummy()

── Model ───────────────────────────────────────────────────────────────────────
Logistic Regression Model Specification (classification)

Main Arguments:
  penalty = tune()
  mixture = 1

Computational engine: glmnet </code></pre>
</div>
</div>
</section>
<section id="la-cuadrícula" class="slide level2">
<h2>La Cuadrícula</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Una búsqueda en cuadrícula explora sistemáticamente diferentes valores de penalización (por ejemplo, 0.001, 0.01, 0.1, 1, 10).</li>
<li>El rendimiento del modelo se evalúa para cada combinación de valores de penalización.</li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="img/grid.gif"></p>
</div></div>
</section>
<section id="la-cuadrícula-1" class="slide level2">
<h2>La Cuadrícula</h2>
<p><img data-src="https://dials.tidymodels.org/logo.png" class="absolute" style="top: 0px; right: 0px; width: 80px; height: 90px; "></p>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">1</a></li><li><a href="#tabset-1-2">2</a></li><li><a href="#tabset-1-3">3</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb16" data-code-line-numbers="1|2|3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a><span class="co"># Usado para la clase del Dr. Balise</span></span>
<span id="cb16-2"><a href=""></a>glmnet_grid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">penalty =</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">20</span>))</span>
<span id="cb16-3"><a href=""></a>glmnet_grid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>        penalty
1  1.000000e-06
2  1.832981e-06
3  3.359818e-06
4  6.158482e-06
5  1.128838e-05
6  2.069138e-05
7  3.792690e-05
8  6.951928e-05
9  1.274275e-04
10 2.335721e-04
11 4.281332e-04
12 7.847600e-04
13 1.438450e-03
14 2.636651e-03
15 4.832930e-03
16 8.858668e-03
17 1.623777e-02
18 2.976351e-02
19 5.455595e-02
20 1.000000e-01</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb18" data-code-line-numbers="1|2|3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href=""></a><span class="co"># Lo inventé</span></span>
<span id="cb18-2"><a href=""></a>penalty_grid <span class="ot">&lt;-</span> <span class="fu">grid_regular</span>(<span class="fu">penalty</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>)), <span class="at">levels =</span> <span class="dv">50</span>)</span>
<span id="cb18-3"><a href=""></a>penalty_grid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 1
    penalty
      &lt;dbl&gt;
 1 0.0001  
 2 0.000146
 3 0.000212
 4 0.000309
 5 0.000450
 6 0.000655
 7 0.000954
 8 0.00139 
 9 0.00202 
10 0.00295 
# ℹ 40 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3">
<div class="cell">
<div class="sourceCode cell-code" id="cb20" data-code-line-numbers="1|2|3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href=""></a><span class="co"># Lo que recomendaría</span></span>
<span id="cb20-2"><a href=""></a>lambda_grid <span class="ot">&lt;-</span> <span class="fu">grid_regular</span>(<span class="fu">penalty</span>(), <span class="at">levels =</span> <span class="dv">50</span>)</span>
<span id="cb20-3"><a href=""></a>lambda_grid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 1
    penalty
      &lt;dbl&gt;
 1 1   e-10
 2 1.60e-10
 3 2.56e-10
 4 4.09e-10
 5 6.55e-10
 6 1.05e- 9
 7 1.68e- 9
 8 2.68e- 9
 9 4.29e- 9
10 6.87e- 9
# ℹ 40 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="cómo-determinar-la-cuadrícula" class="slide level2">
<h2>¿Cómo determinar la cuadrícula?</h2>
<p><img data-src="img/grid_search_3.png" class="absolute" style=""></p>
<div class="footer">
<p><a href="https://pubmed.ncbi.nlm.nih.gov/20808728/">Link to Article</a></p>
</div>
</section>
<section id="cómo-determinar-la-cuadrícula-1" class="slide level2">
<h2>¿Cómo determinar la cuadrícula?</h2>
<p><img data-src="img/grid_search_2.png" class="absolute" style=""></p>
<div class="footer">
<p><a href="https://emilhvitfeldt.github.io/ISLR-tidymodels-labs/06-regularization.html">ISLR tidymodels labs</a></p>
</div>
</section>
<section id="ajustar-la-cuadrícula-usando-el-flujo-de-trabajo" class="slide level2">
<h2>Ajustar la Cuadrícula Usando el Flujo de Trabajo</h2>
<p><img data-src="https://tune.tidymodels.org/logo.png" class="absolute" style="top: 0px; right: 0px; width: 80px; height: 90px; "> <br> <br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" data-code-line-numbers="1|3|5|6|7|8|9|10|11|12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href=""></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>()</span>
<span id="cb22-2"><a href=""></a></span>
<span id="cb22-3"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">2023</span>)</span>
<span id="cb22-4"><a href=""></a></span>
<span id="cb22-5"><a href=""></a>lasso_tune <span class="ot">&lt;-</span> </span>
<span id="cb22-6"><a href=""></a>  <span class="fu">tune_grid</span>(</span>
<span id="cb22-7"><a href=""></a>  <span class="at">object =</span> texting_wf, </span>
<span id="cb22-8"><a href=""></a>  <span class="at">resamples =</span> analysis_folds,</span>
<span id="cb22-9"><a href=""></a>  <span class="at">grid =</span> lambda_grid, </span>
<span id="cb22-10"><a href=""></a>  <span class="at">control =</span> <span class="fu">control_resamples</span>(<span class="at">event_level =</span> <span class="st">"second"</span>)</span>
<span id="cb22-11"><a href=""></a>)</span>
<span id="cb22-12"><a href=""></a></span>
<span id="cb22-13"><a href=""></a>doParallel<span class="sc">::</span><span class="fu">stopImplicitCluster</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
</section>
<section id="recolectar-las-métricas" class="slide level2">
<h2>Recolectar las Métricas</h2>
<p><img data-src="https://tune.tidymodels.org/logo.png" class="absolute" style="top: 0px; right: 0px; width: 80px; height: 90px; "> <br> <br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" data-code-line-numbers="1|2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href=""></a>lasso_tune <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href=""></a>  <span class="fu">collect_metrics</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 150 × 7
    penalty .metric     .estimator  mean     n std_err .config         
      &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;           
 1 1   e-10 accuracy    binary     0.575     5 0.00568 pre0_mod01_post0
 2 1   e-10 brier_class binary     0.289     5 0.00103 pre0_mod01_post0
 3 1   e-10 roc_auc     binary     0.604     5 0.00541 pre0_mod01_post0
 4 1.60e-10 accuracy    binary     0.575     5 0.00568 pre0_mod02_post0
 5 1.60e-10 brier_class binary     0.289     5 0.00103 pre0_mod02_post0
 6 1.60e-10 roc_auc     binary     0.604     5 0.00541 pre0_mod02_post0
 7 2.56e-10 accuracy    binary     0.575     5 0.00568 pre0_mod03_post0
 8 2.56e-10 brier_class binary     0.289     5 0.00103 pre0_mod03_post0
 9 2.56e-10 roc_auc     binary     0.604     5 0.00541 pre0_mod03_post0
10 4.09e-10 accuracy    binary     0.575     5 0.00568 pre0_mod04_post0
# ℹ 140 more rows</code></pre>
</div>
</div>
</section>
<section id="visualizar-las-métricas" class="slide level2">
<h2>Visualizar las Métricas</h2>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">autoplot</a></li><li><a href="#tabset-2-2">ggplot</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href=""></a><span class="fu">autoplot</span>(lasso_tune)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="session_3_lasso_files/figure-revealjs/unnamed-chunk-17-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb26" data-code-line-numbers="1|2|3|4|5|6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href=""></a>lasso_tune <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a href=""></a>  <span class="fu">collect_metrics</span>() <span class="sc">|&gt;</span> </span>
<span id="cb26-3"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(penalty, mean, <span class="at">color =</span> .metric)) <span class="sc">+</span></span>
<span id="cb26-4"><a href=""></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb26-5"><a href=""></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>.metric, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb26-6"><a href=""></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="session_3_lasso_files/figure-revealjs/unnamed-chunk-18-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="eligiendo-nuestro-parámetro-final" class="slide level2">
<h2>Eligiendo nuestro parámetro final</h2>
<p><img data-src="https://tune.tidymodels.org/logo.png" class="absolute" style="top: 0px; right: 0px; width: 80px; height: 90px; "> <br> <br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" data-code-line-numbers="1|2|4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href=""></a>best <span class="ot">&lt;-</span> lasso_tune <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href=""></a>  <span class="fu">select_best</span>(<span class="at">metric =</span> <span class="st">"roc_auc"</span>)</span>
<span id="cb27-3"><a href=""></a></span>
<span id="cb27-4"><a href=""></a>best</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
       penalty .config         
         &lt;dbl&gt; &lt;chr&gt;           
1 0.0000000001 pre0_mod01_post0</code></pre>
</div>
</div>
</section>
<section id="finalizar-el-flujo-de-trabajo" class="slide level2">
<h2>Finalizar el Flujo de Trabajo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" data-code-line-numbers="1|3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href=""></a>final_wf <span class="ot">&lt;-</span> <span class="fu">finalize_workflow</span>(texting_wf, best)</span>
<span id="cb29-2"><a href=""></a></span>
<span id="cb29-3"><a href=""></a>final_wf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: logistic_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
5 Recipe Steps

• step_zv()
• step_impute_mode()
• step_impute_mean()
• step_normalize()
• step_dummy()

── Model ───────────────────────────────────────────────────────────────────────
Logistic Regression Model Specification (classification)

Main Arguments:
  penalty = 1e-10
  mixture = 1

Computational engine: glmnet </code></pre>
</div>
</div>
</section>
<section id="ajustemos-el-modelo" class="slide level2">
<h2>¡Ajustemos el Modelo!</h2>
<div class="columns">
<div class="column" style="width:70%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb31" data-code-line-numbers="1|2|4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href=""></a>texting_fit <span class="ot">&lt;-</span> </span>
<span id="cb31-2"><a href=""></a>  <span class="fu">fit</span>(final_wf, <span class="at">data =</span> analysis_train)</span>
<span id="cb31-3"><a href=""></a></span>
<span id="cb31-4"><a href=""></a>texting_fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow [trained] ══════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: logistic_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
5 Recipe Steps

• step_zv()
• step_impute_mode()
• step_impute_mean()
• step_normalize()
• step_dummy()

── Model ───────────────────────────────────────────────────────────────────────

Call:  glmnet::glmnet(x = maybe_matrix(x), y = y, family = "binomial",      alpha = ~1) 

   Df %Dev   Lambda
1   0 0.00 0.066580
2   1 0.22 0.060660
3   1 0.41 0.055280
4   1 0.56 0.050360
5   1 0.69 0.045890
6   1 0.79 0.041810
7   2 0.92 0.038100
8   2 1.03 0.034710
9   3 1.13 0.031630
10  4 1.24 0.028820
11  6 1.38 0.026260
12  7 1.51 0.023930
13  8 1.63 0.021800
14 10 1.75 0.019860
15 10 1.86 0.018100
16 13 1.96 0.016490
17 16 2.06 0.015030
18 18 2.17 0.013690
19 20 2.28 0.012480
20 21 2.39 0.011370
21 21 2.48 0.010360
22 23 2.56 0.009437
23 23 2.64 0.008599
24 26 2.73 0.007835
25 29 2.81 0.007139
26 30 2.88 0.006505
27 32 2.95 0.005927
28 32 3.02 0.005400
29 33 3.09 0.004921
30 33 3.14 0.004484
31 34 3.19 0.004085
32 34 3.23 0.003722
33 34 3.26 0.003392
34 34 3.29 0.003090
35 36 3.32 0.002816
36 39 3.34 0.002566
37 40 3.37 0.002338
38 42 3.39 0.002130
39 43 3.42 0.001941
40 44 3.43 0.001768
41 46 3.45 0.001611
42 46 3.46 0.001468
43 46 3.48 0.001338
44 46 3.49 0.001219
45 46 3.49 0.001111
46 46 3.50 0.001012

...
and 8 more lines.</code></pre>
</div>
</div>
</div><div class="column" style="width:30%;">
<p><img data-src="img/woddy_fit.gif"></p>
</div></div>
</section>
<section id="revisar-el-ajuste-en-los-datos-de-entrenamiento" class="slide level2">
<h2>Revisar el ajuste en los datos de entrenamiento</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" data-code-line-numbers="1|2|3|4|6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href=""></a>texting_pred <span class="ot">&lt;-</span> </span>
<span id="cb33-2"><a href=""></a>  <span class="fu">augment</span>(texting_fit, analysis_train) <span class="sc">|&gt;</span> </span>
<span id="cb33-3"><a href=""></a>  <span class="fu">select</span>(TextingDriving, .pred_class, .pred_1, .pred_0)</span>
<span id="cb33-4"><a href=""></a></span>
<span id="cb33-5"><a href=""></a>texting_pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8,169 × 4
   TextingDriving .pred_class .pred_1 .pred_0
   &lt;fct&gt;          &lt;fct&gt;         &lt;dbl&gt;   &lt;dbl&gt;
 1 0              1             0.569   0.431
 2 0              0             0.406   0.594
 3 0              0             0.479   0.521
 4 0              1             0.544   0.456
 5 0              1             0.507   0.493
 6 0              0             0.454   0.546
 7 0              1             0.580   0.420
 8 0              0             0.462   0.538
 9 0              1             0.587   0.413
10 0              1             0.508   0.492
# ℹ 8,159 more rows</code></pre>
</div>
</div>
</section>
<section id="gráfico-roc-y-valor-auc" class="slide level2">
<h2>Gráfico ROC y valor AUC</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb35" data-code-line-numbers="1|2|3|4|5|7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href=""></a>roc_plot_training <span class="ot">&lt;-</span> </span>
<span id="cb35-2"><a href=""></a>  texting_pred <span class="sc">|&gt;</span> </span>
<span id="cb35-3"><a href=""></a>  <span class="fu">roc_curve</span>(<span class="at">truth =</span> TextingDriving, .pred_1, <span class="at">event_level =</span> <span class="st">"second"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-4"><a href=""></a>  <span class="fu">autoplot</span>()</span>
<span id="cb35-5"><a href=""></a></span>
<span id="cb35-6"><a href=""></a>roc_plot_training </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="session_3_lasso_files/figure-revealjs/unnamed-chunk-23-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb36" data-code-line-numbers="1|2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href=""></a>texting_pred <span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href=""></a>    <span class="fu">roc_auc</span>(<span class="at">truth =</span> TextingDriving, .pred_1, <span class="at">event_level =</span> <span class="st">"second"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  .metric .estimator .estimate
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
1 roc_auc binary         0.619</code></pre>
</div>
</div>
</div></div>
</section>
<section id="verificar-las-estimaciones" class="slide level2">
<h2>Verificar las estimaciones</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb38" data-code-line-numbers="1|2|3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href=""></a>texting_fit <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href=""></a>  <span class="fu">extract_fit_parsnip</span>() <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href=""></a>  <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 51 × 3
   term                 estimate      penalty
   &lt;chr&gt;                   &lt;dbl&gt;        &lt;dbl&gt;
 1 (Intercept)           0.391   0.0000000001
 2 DrinkingDriver       -0.00902 0.0000000001
 3 WeaponCarrying        0.0695  0.0000000001
 4 WeaponCarryingSchool  0.0524  0.0000000001
 5 GunCarrying           0.109   0.0000000001
 6 UnsafeAtSchool        0.0525  0.0000000001
 7 InjuredInSchool       0.00744 0.0000000001
 8 PhysicalFight        -0.0484  0.0000000001
 9 SchoolPhysicalFight  -0.0359  0.0000000001
10 TimesSexualAbuse      0.0652  0.0000000001
# ℹ 41 more rows</code></pre>
</div>
</div>
</section>
<section id="veamos-las-métricas-en-los-remuestreos" class="slide level2">
<h2>Veamos las métricas en los remuestreos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" data-code-line-numbers="1|2|4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href=""></a>texting_fit_resamples <span class="ot">&lt;-</span> </span>
<span id="cb40-2"><a href=""></a>  <span class="fu">fit_resamples</span>(final_wf, <span class="at">resamples =</span> analysis_folds)</span>
<span id="cb40-3"><a href=""></a></span>
<span id="cb40-4"><a href=""></a>texting_fit_resamples</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># Resampling results
# 5-fold cross-validation 
# A tibble: 5 × 4
  splits              id    .metrics         .notes          
  &lt;list&gt;              &lt;chr&gt; &lt;list&gt;           &lt;list&gt;          
1 &lt;split [6535/1634]&gt; Fold1 &lt;tibble [3 × 4]&gt; &lt;tibble [0 × 4]&gt;
2 &lt;split [6535/1634]&gt; Fold2 &lt;tibble [3 × 4]&gt; &lt;tibble [0 × 4]&gt;
3 &lt;split [6535/1634]&gt; Fold3 &lt;tibble [3 × 4]&gt; &lt;tibble [0 × 4]&gt;
4 &lt;split [6535/1634]&gt; Fold4 &lt;tibble [3 × 4]&gt; &lt;tibble [0 × 4]&gt;
5 &lt;split [6536/1633]&gt; Fold5 &lt;tibble [3 × 4]&gt; &lt;tibble [0 × 4]&gt;</code></pre>
</div>
</div>
</section>
<section id="explorando-los-resultados" class="slide level2">
<h2>Explorando los resultados</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42" data-code-line-numbers="1|2|4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href=""></a><span class="fu">collect_metrics</span>(texting_fit_resamples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  .metric     .estimator  mean     n std_err .config        
  &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;          
1 accuracy    binary     0.575     5 0.00568 pre0_mod0_post0
2 brier_class binary     0.239     5 0.00102 pre0_mod0_post0
3 roc_auc     binary     0.604     5 0.00541 pre0_mod0_post0</code></pre>
</div>
</div>
</section>
<section id="ajustemos-en-los-datos-de-prueba" class="slide level2">
<h2>Ajustemos en los Datos de <strong>PRUEBA</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb44" data-code-line-numbers="1|2|3|4|5|6|8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href=""></a>texting_last_fit <span class="ot">&lt;-</span> </span>
<span id="cb44-2"><a href=""></a>  <span class="fu">last_fit</span>(final_wf,</span>
<span id="cb44-3"><a href=""></a>           <span class="at">split =</span> analysis_split,</span>
<span id="cb44-4"><a href=""></a>           <span class="at">metrics =</span> <span class="fu">metric_set</span>(accuracy, kap, roc_auc))</span>
<span id="cb44-5"><a href=""></a></span>
<span id="cb44-6"><a href=""></a>texting_last_fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># Resampling results
# Manual resampling 
# A tibble: 1 × 6
  splits              id               .metrics .notes   .predictions .workflow 
  &lt;list&gt;              &lt;chr&gt;            &lt;list&gt;   &lt;list&gt;   &lt;list&gt;       &lt;list&gt;    
1 &lt;split [8169/2725]&gt; train/test split &lt;tibble&gt; &lt;tibble&gt; &lt;tibble&gt;     &lt;workflow&gt;</code></pre>
</div>
</div>
</section>
<section id="recolectar-las-métricas-1" class="slide level2">
<h2>Recolectar las Métricas</h2>
<p><img data-src="https://tune.tidymodels.org/logo.png" class="absolute" style="top: 0px; right: 0px; width: 80px; height: 90px; "> <br> <br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href=""></a><span class="fu">collect_metrics</span>(texting_last_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  .metric  .estimator .estimate .config        
  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;          
1 accuracy binary         0.579 pre0_mod0_post0
2 kap      binary         0.123 pre0_mod0_post0
3 roc_auc  binary         0.605 pre0_mod0_post0</code></pre>
</div>
</div>
</section>
<section id="revisar-predicciones-en-los-datos-de-prueba-con-yardstick" class="slide level2">
<h2>Revisar Predicciones en los Datos de Prueba con <code>yardstick</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb48" data-code-line-numbers="1|2|3|5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href=""></a>the_prediction <span class="ot">&lt;-</span>  </span>
<span id="cb48-2"><a href=""></a>  texting_last_fit <span class="sc">|&gt;</span> </span>
<span id="cb48-3"><a href=""></a>  <span class="fu">collect_predictions</span>() <span class="sc">|&gt;</span> </span>
<span id="cb48-4"><a href=""></a>  <span class="fu">select</span>(<span class="sc">-</span>.config, <span class="sc">-</span>.row)</span>
<span id="cb48-5"><a href=""></a>  </span>
<span id="cb48-6"><a href=""></a></span>
<span id="cb48-7"><a href=""></a>the_prediction </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,725 × 5
   .pred_class .pred_0 .pred_1 id               TextingDriving
   &lt;fct&gt;         &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;            &lt;fct&gt;         
 1 1             0.375   0.625 train/test split 1             
 2 1             0.499   0.501 train/test split 0             
 3 1             0.224   0.776 train/test split 0             
 4 1             0.470   0.530 train/test split 1             
 5 1             0.335   0.665 train/test split 1             
 6 0             0.532   0.468 train/test split 0             
 7 0             0.541   0.459 train/test split 0             
 8 1             0.410   0.590 train/test split 0             
 9 0             0.530   0.470 train/test split 1             
10 1             0.478   0.522 train/test split 1             
# ℹ 2,715 more rows</code></pre>
</div>
</div>
</section>
<section id="revisar-predicciones-en-los-datos-de-prueba-con-yardstick-1" class="slide level2">
<h2>Revisar Predicciones en los Datos de Prueba con <code>yardstick</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb50" data-code-line-numbers="1|3|4|5|6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href=""></a>multi_metric <span class="ot">&lt;-</span> <span class="fu">metric_set</span>(sens, spec, accuracy, kap)</span>
<span id="cb50-2"><a href=""></a></span>
<span id="cb50-3"><a href=""></a><span class="fu">multi_metric</span>(the_prediction, </span>
<span id="cb50-4"><a href=""></a>             <span class="at">truth =</span> TextingDriving, </span>
<span id="cb50-5"><a href=""></a>             <span class="at">estimate =</span> .pred_class, </span>
<span id="cb50-6"><a href=""></a>             <span class="at">event_level =</span> <span class="st">"second"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  .metric  .estimator .estimate
  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
1 sens     binary         0.738
2 spec     binary         0.381
3 accuracy binary         0.579
4 kap      binary         0.123</code></pre>
</div>
</div>
</section>
<section id="matriz-de-confusión-en-los-datos-de-prueba" class="slide level2">
<h2>Matriz de Confusión en los Datos de Prueba</h2>

<img data-src="session_3_lasso_files/figure-revealjs/unnamed-chunk-32-1.png" width="960" class="r-stretch"></section>
<section id="curva-roc-en-los-datos-de-prueba" class="slide level2">
<h2>Curva ROC en los Datos de Prueba</h2>

<img data-src="session_3_lasso_files/figure-revealjs/unnamed-chunk-33-1.png" width="960" class="r-stretch"></section>
<section id="gráfico-de-importancia-de-variables" class="slide level2">
<h2>Gráfico de Importancia de Variables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb52" data-code-line-numbers="1|3|4|4|5|6|7|8|9|10|11|12|13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href=""></a><span class="fu">library</span>(vip)</span>
<span id="cb52-2"><a href=""></a></span>
<span id="cb52-3"><a href=""></a>texting_last_fit <span class="sc">|&gt;</span> </span>
<span id="cb52-4"><a href=""></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">|&gt;</span> </span>
<span id="cb52-5"><a href=""></a>  <span class="fu">vi</span>() <span class="sc">|&gt;</span> </span>
<span id="cb52-6"><a href=""></a>  <span class="fu">group_by</span>(Sign) <span class="sc">|&gt;</span> </span>
<span id="cb52-7"><a href=""></a>  <span class="fu">slice_max</span>(Importance, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb52-8"><a href=""></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb52-9"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Importance, <span class="fu">fct_reorder</span>(Variable, Importance), <span class="at">fill =</span> Sign)) <span class="sc">+</span> </span>
<span id="cb52-10"><a href=""></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb52-11"><a href=""></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Sign), <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb52-12"><a href=""></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb52-13"><a href=""></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="session_3_lasso_files/figure-revealjs/unnamed-chunk-34-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="lo-logramos" class="slide level2">
<h2>¡Lo logramos!</h2>

<img data-src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExMTh3aWhnbWl5c3RkYm54OHlidjdsd2dsdnhtZDh0YzFrbjV2enBybiZlcD12MV9naWZzX3NlYXJjaCZjdD1n/nVXzt7FSJlX7W/giphy.gif" class="r-stretch"></section>
<section id="preguntas-de-revisión" class="slide level2 scrollable">
<h2>Preguntas de Revisión</h2>
<div class="fragment">
<ol type="1">
<li>¿Es la Suma Residual de Cuadrados un concepto relevante para las penalizaciones L1 y L2? ¿por qué?</li>
</ol>
</div>
<div class="fragment">
<ol start="2" type="1">
<li>¿La regularización L2 sería mejor si la llamáramos regularización al cuadrado?</li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li>Si quiero reducir la dimensionalidad de un conjunto de datos usaría la penalización _______?</li>
</ol>
</div>
<div class="fragment">
<ol start="4" type="1">
<li>Si quiero que <code>tidymodels</code> realice una regresión ridge, ¿qué debo cambiar en este código?</li>
</ol>
<p>#| echo: true review_spec &lt;- logistic_reg(penalty = tune(), mixture = tune()) |&gt; set_engine(‘glmnet’)</p>
<p>` ``</p>
</div>
<div class="fragment">
<ol start="5" type="1">
<li>BONUS: stepwise vs.&nbsp;lasso</li>
</ol>
</div>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="session_3_lasso_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="session_3_lasso_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="session_3_lasso_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="session_3_lasso_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="session_3_lasso_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="session_3_lasso_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="session_3_lasso_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="session_3_lasso_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="session_3_lasso_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="session_3_lasso_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: true,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>